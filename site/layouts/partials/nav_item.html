{{ $parentId := .menuItem.Identifier }}
{{ $currentPage := .currentPage }}
{{ $courseId := .courseId }}
{{ $show := partial "ismenucurrent_recursive.html" (dict "menuItem" .menuItem "currentPage" $currentPage "courseId" $courseId "text" " show") }}
{{ $ariaExpanded := partial "ismenucurrent_recursive.html" (dict "menuItem" .menuItem "currentPage" $currentPage "courseId" $courseId "text" "true") }}

<li class="course-nav-list-item">
  <div class="position-relative pt-2 pb-2{{ if .menuItem.HasChildren }} pr-3{{ end }}">
    <span class="course-nav-text-wrapper">
      <a class="text-uppercase text-dark{{ if $currentPage.IsMenuCurrent $courseId .menuItem }} active{{ end }}"
        href="{{ .menuItem.URL | relURL }}">
        {{ .menuItem.Name }}
      </a>
    </span>
    {{ if .menuItem.HasChildren }}
    <a class="course-nav-section-toggle" 
      href="#nav-container_{{ .menuItem.Identifier }}" 
      data-toggle="collapse" 
      aria-controls="nav-container_{{ .menuItem.Identifier }}" 
      aria-expanded="{{- $ariaExpanded -}}">
      <i class="material-icons md-18"></i>
    </a>
    {{ end }}
  </div>
  {{ with .parentId }}
  {{ else }}
  <span class="medium-and-below-only"><hr/></span>
  {{ end }}
  {{ if .menuItem.HasChildren }}
  <div class="collapse{{- $show -}}" 
    id="nav-container_{{ .menuItem.Identifier }}">
    <ul class="course-nav-child-nav m-auto">
      {{ range .menuItem.Children }}
        {{ partial "nav_item.html" (dict "menuItem" . "currentPage" $currentPage "courseId" $courseId "parentId" $parentId ) }}
      {{ end }}
    </ul>
  </div>
  {{ end }}
</li>
