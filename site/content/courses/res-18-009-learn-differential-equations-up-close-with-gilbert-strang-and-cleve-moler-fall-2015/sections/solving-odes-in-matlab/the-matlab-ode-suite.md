---
about_this_resource_text: >-
  <p><strong>Descriptions: </strong>The MATLAB<sup>&reg;</sup> documentation
  provides two charts summarizing the features of each of the seven functions in
  the MATLAB ODE suite.</p><p><a
  href="http://www.mathworks.com/matlabcentral/fileexchange/54611">Related
  MATLAB code files can be downloaded from MATLAB Central</a></p>
  <p><strong>Instructor:</strong> Cleve Moler</p>
embedded_media:
  - id: Video-YouTube-Stream
    media_location: cQKR5m5pTTg
    parent_uid: d255105b3f1c9a1de9fbbc907b26972c
    title: Video-YouTube-Stream
    type: Video
    uid: 78462960a40a0f8c75b1c858b6235e9c
  - id: Thumbnail-YouTube-JPG
    media_location: 'https://img.youtube.com/vi/cQKR5m5pTTg/default.jpg'
    parent_uid: d255105b3f1c9a1de9fbbc907b26972c
    title: Thumbnail-YouTube-JPG
    type: Thumbnail
    uid: 0b0d4bc707dbc185fbc54bd2e65bb6e7
  - id: 3Play-3PlayYouTubeid-MP4
    media_location: cQKR5m5pTTg
    parent_uid: d255105b3f1c9a1de9fbbc907b26972c
    title: 3Play-3Play YouTube id
    type: 3Play
    uid: e17df8252d9a873bfc3ec8c04deef3cc
  - id: cQKR5m5pTTg.srt
    parent_uid: d255105b3f1c9a1de9fbbc907b26972c
    technical_location: >-
      https://ocw.mit.edu/resources/res-18-009-learn-differential-equations-up-close-with-gilbert-strang-and-cleve-moler-fall-2015/solving-odes-in-matlab/the-matlab-ode-suite/cQKR5m5pTTg.srt
    title: 3play caption file
    type: null
    uid: f120c6c48ce47f78a6be1dc15ce9ae69
  - id: cQKR5m5pTTg.pdf
    parent_uid: d255105b3f1c9a1de9fbbc907b26972c
    technical_location: >-
      https://ocw.mit.edu/resources/res-18-009-learn-differential-equations-up-close-with-gilbert-strang-and-cleve-moler-fall-2015/solving-odes-in-matlab/the-matlab-ode-suite/cQKR5m5pTTg.pdf
    title: 3play pdf file
    type: null
    uid: 2d1f3884d744452977ea80b2d7ff8d8e
  - id: Caption-3Play YouTube id-SRT
    parent_uid: d255105b3f1c9a1de9fbbc907b26972c
    title: Caption-3Play YouTube id-SRT-English - US
    type: Caption
    uid: 6576489473544c048fbea2f3be6cbf0c
  - id: Transcript-3Play YouTube id-PDF
    parent_uid: d255105b3f1c9a1de9fbbc907b26972c
    title: Transcript-3Play YouTube id-PDF-English - US
    type: Transcript
    uid: 3d8b45e13c62ff72e9d0bfb1ec9f8874
  - id: Video-iTunesU-MP4
    media_location: 'https://itunes.apple.com/us/itunes-u/id1102923623'
    parent_uid: d255105b3f1c9a1de9fbbc907b26972c
    title: Video-iTunes U-MP4
    type: Video
    uid: ec403b6d63f57ff96f1f61c7e86bb536
  - id: Video-InternetArchive-MP4
    media_location: >-
      https://archive.org/download/MITRES18-009F15/MITRES18-009F15_odes_09_300k.mp4
    parent_uid: d255105b3f1c9a1de9fbbc907b26972c
    title: Video-Internet Archive-MP4
    type: Video
    uid: a5806162d6bc1e82aaead0c562a07808
inline_embed_id: 37324548thematlabodesuite21772351
order_index: 654
parent_uid: 8ee92c27f02bfd86d2629f4ce23755ef
related_resources_text: ''
short_url: the-matlab-ode-suite
technical_location: >-
  https://ocw.mit.edu/resources/res-18-009-learn-differential-equations-up-close-with-gilbert-strang-and-cleve-moler-fall-2015/solving-odes-in-matlab/the-matlab-ode-suite
title: The MATLAB ODE Suite
transcript: >-
  <p><span m='3297'>PROFESSOR: </span> <span m='3770'>We</span> <span
  m='3950'>can</span> <span m='4140'>get</span> <span m='4460'>to</span> <span
  m='5310'>documentation</span> <span m='6200'>for</span> <span
  m='6290'>the</span> <span m='6400'>MATLAB</span> <span m='7000'>ODE</span>
  <span m='7620'>Suite</span> <span m='8170'>by</span> <span
  m='9160'>entering</span> <span m='9670'>this</span> <span
  m='9970'>command</span> <span m='10630'>at</span> <span m='10770'>the</span>
  <span m='10860'>MATLAB</span> <span m='11480'>prompt--</span> <span
  m='12050'>doc</span> <span m='12940'>ode45.</span> <span m='16430'>This</span>
  <span m='16690'>will</span> <span m='16850'>bring</span> <span
  m='17150'>us</span> <span m='17350'>to</span> <span m='18120'>an</span> <span
  m='18580'>extensive</span> <span m='19200'>documentation</span> <span
  m='20240'>for</span> <span m='20800'>MATLAB</span> <span
  m='21050'>ode45</span> <span m='23430'>that</span> <span
  m='23590'>includes</span> <span m='24130'>among</span> <span
  m='24470'>other</span> <span m='24700'>things</span> <span
  m='25490'>this</span> <span m='25810'>chart</span> <span m='26320'>that</span>
  <span m='27080'>compares</span> <span m='28340'>MATLAB</span> <span
  m='29000'>ODE</span> <span m='29620'>solvers.</span> <span
  m='31050'>There</span> <span m='31290'>are</span> <span m='31340'>seven</span>
  <span m='31840'>of</span> <span m='32025'>them</span> <span
  m='33990'>and</span> <span m='35670'>this</span> <span
  m='36000'>compares</span> <span m='36540'>their</span> <span
  m='36700'>various</span> <span m='37240'>attributes.</span> <span
  m='40810'>As</span> <span m='41020'>we've</span> <span m='41220'>said</span>
  <span m='41480'>before,</span> <span m='42660'>MATLAB</span> <span
  m='43210'>ode45</span> <span m='44760'>is</span> <span m='44930'>the</span>
  <span m='45010'>workhorse.</span> <span m='46550'>It's</span> <span
  m='46810'>a</span> <span m='46930'>nonstiff</span> <span
  m='47810'>solver</span> <span m='49110'>with</span> <span
  m='49780'>medium</span> <span m='50440'>accuracy</span> <span
  m='51910'>that</span> <span m='52210'>is</span> <span m='52520'>the</span>
  <span m='53180'>first</span> <span m='53600'>one</span> <span
  m='53790'>you</span> <span m='53910'>should</span> <span m='54170'>try,</span>
  <span m='54620'>and</span> <span m='54785'>we</span> <span
  m='54950'>use</span> <span m='55290'>it</span> <span m='55410'>most</span>
  <span m='55750'>of</span> <span m='55850'>the</span> <span
  m='56010'>time.</span> </p><p><span m='58530'>I</span> <span
  m='58790'>have</span> <span m='59010'>a</span> <span m='59080'>soft</span>
  <span m='59540'>heart</span> <span m='59870'>in</span> <span
  m='59955'>my</span> <span m='60040'>heart</span> <span m='60380'>for</span>
  <span m='60510'>MATLAB</span> <span m='61370'>ode23.</span> <span
  m='63540'>It's</span> <span m='63770'>a</span> <span m='63840'>nonstiff</span>
  <span m='64879'>solver</span> <span m='66060'>with</span> <span
  m='66610'>low</span> <span m='66980'>accuracy,</span> <span
  m='68320'>but</span> <span m='68460'>its</span> <span
  m='68670'>accuracy</span> <span m='69390'>that's</span> <span
  m='69630'>appropriate</span> <span m='70370'>for</span> <span
  m='70660'>graphics</span> <span m='71310'>work</span> <span
  m='71750'>because</span> <span m='73790'>the</span> <span
  m='73930'>step</span> <span m='74250'>size</span> <span m='74690'>it</span>
  <span m='74890'>chooses</span> <span m='77320'>is</span> <span
  m='77500'>appropriate</span> <span m='78260'>for</span> <span
  m='78710'>most</span> <span m='79090'>graphics</span> <span
  m='79700'>work.</span> <span m='81900'>MATLAB</span> <span
  m='83870'>ode113</span> <span m='86230'>we</span> <span
  m='86400'>haven't</span> <span m='86760'>talked</span> <span
  m='87100'>about</span> <span m='87420'>it</span> <span m='87600'>yet,</span>
  <span m='91530'>there</span> <span m='91590'>could</span> <span
  m='91740'>be</span> <span m='91870'>a</span> <span m='91940'>comma</span>
  <span m='92330'>between</span> <span m='92760'>the</span> <span
  m='92860'>1</span> <span m='93340'>and</span> <span m='93415'>the</span> <span
  m='93490'>13</span> <span m='94110'>here</span> <span m='94380'>because</span>
  <span m='94810'>this</span> <span m='95030'>is</span> <span m='95220'>a</span>
  <span m='95880'>variable</span> <span m='96660'>order</span> <span
  m='96970'>method</span> <span m='98010'>where</span> <span
  m='98180'>the</span> <span m='98380'>order</span> <span
  m='98820'>varies</span> <span m='99290'>all</span> <span m='99490'>the</span>
  <span m='99590'>way</span> <span m='99830'>from</span> <span
  m='100130'>1</span> <span m='100490'>to</span> <span m='100590'>13.</span>
  <span m='102170'>It's</span> <span m='102420'>a</span> <span
  m='102470'>multi-step</span> <span m='103260'>method</span> <span
  m='103740'>that</span> <span m='103910'>saves</span> <span
  m='104900'>history.</span> </p><p><span m='106290'>If,</span> <span
  m='107270'>you</span> <span m='107360'>know</span> <span
  m='107530'>about</span> <span m='107810'>these</span> <span
  m='108150'>things,</span> <span m='108540'>it's</span> <span
  m='108740'>an</span> <span m='109595'>Adams-Moulton</span> <span
  m='112570'>method.</span> <span m='115820'>I</span> <span
  m='116070'>associate</span> <span m='116770'>this</span> <span
  m='117040'>with</span> <span m='117270'>worked</span> <span
  m='117397'>done</span> <span m='117780'>at</span> <span m='117870'>Jet</span>
  <span m='118130'>Propulsion</span> <span m='118690'>Laboratory</span> <span
  m='119990'>years</span> <span m='120320'>ago</span> <span
  m='120700'>for</span> <span m='121070'>computing</span> <span
  m='123390'>orbits</span> <span m='124030'>of</span> <span
  m='124620'>planets</span> <span m='125290'>and</span> <span
  m='125700'>satellites,</span> <span m='126840'>which</span> <span
  m='127150'>of</span> <span m='127250'>course</span> <span
  m='127650'>are</span> <span m='128660'>very</span> <span
  m='129009'>smooth</span> <span m='130259'>and</span> <span
  m='130509'>go</span> <span m='130699'>on</span> <span m='130960'>for</span>
  <span m='131110'>years.</span> <span m='132870'>It</span> <span
  m='133110'>can</span> <span m='135510'>have</span> <span
  m='136470'>very</span> <span m='136890'>high</span> <span
  m='137190'>accuracy</span> <span m='137960'>requirements.</span> </p><p><span
  m='140410'>Then</span> <span m='140670'>there</span> <span
  m='140790'>are</span> <span m='140890'>the</span> <span
  m='141070'>stiff</span> <span m='141550'>solvers.</span> <span
  m='144900'>There</span> <span m='145020'>are</span> <span
  m='145200'>four</span> <span m='145358'>of</span> <span
  m='145516'>them--</span> <span m='147640'>15s,</span> <span
  m='148790'>23s,</span> <span m='150230'>and</span> <span m='150650'>the</span>
  <span m='151310'>twins,</span> <span m='151920'>the</span> <span
  m='152330'>trapezoid</span> <span m='153140'>rules.</span> <span
  m='156320'>15s</span> <span m='157280'>is</span> <span m='157430'>the</span>
  <span m='157550'>primary</span> <span m='158550'>stiff</span> <span
  m='158880'>solver,</span> <span m='161600'>low</span> <span
  m='161890'>to</span> <span m='162000'>medium</span> <span
  m='162480'>accuracy.</span> <span m='166610'>If</span> <span
  m='166800'>you</span> <span m='166940'>find</span> <span
  m='167350'>ode45</span> <span m='168640'>is</span> <span
  m='168770'>slow,</span> <span m='169900'>taking</span> <span
  m='170320'>lots</span> <span m='170670'>of</span> <span
  m='170760'>steps--</span> <span m='171860'>indication</span> <span
  m='172570'>that</span> <span m='172740'>the</span> <span
  m='172850'>problem</span> <span m='173320'>is</span> <span
  m='173440'>stiff--</span> <span m='174540'>try</span> <span
  m='174920'>15s.</span> </p><p><span m='178200'>23s</span> <span
  m='178960'>can</span> <span m='179470'>be</span> <span m='179710'>as</span>
  <span m='179870'>a</span> <span m='180640'>low</span> <span
  m='180950'>order</span> <span m='181260'>method,</span> <span
  m='182290'>low</span> <span m='182650'>accuracy,</span> <span
  m='184050'>and</span> <span m='184350'>used</span> <span m='184910'>at</span>
  <span m='185400'>crude</span> <span m='185765'>error</span> <span
  m='186530'>tolerances.</span> <span m='188000'>We</span> <span
  m='188130'>haven't</span> <span m='188480'>talked</span> <span
  m='188830'>about</span> <span m='190170'>mass</span> <span
  m='190630'>matrices.</span> <span m='192300'>This</span> <span
  m='192640'>is</span> <span m='192770'>where</span> <span
  m='192920'>there's</span> <span m='193180'>a</span> <span
  m='193250'>matrix</span> <span m='193820'>in</span> <span
  m='193980'>front</span> <span m='194350'>of</span> <span m='194550'>the</span>
  <span m='195740'>derivative</span> <span m='196380'>term,</span> <span
  m='197430'>and</span> <span m='197650'>this</span> <span m='197860'>can</span>
  <span m='198000'>be</span> <span m='198120'>used</span> <span
  m='198440'>with</span> <span m='198660'>constant</span> <span
  m='199350'>mass</span> <span m='199730'>matrices.</span> <span
  m='201320'>And</span> <span m='201580'>then</span> <span m='201710'>the</span>
  <span m='201860'>two</span> <span m='203090'>routines</span> <span
  m='203770'>with</span> <span m='204260'>T's</span> <span m='205220'>in</span>
  <span m='205340'>their</span> <span m='205510'>name</span> <span
  m='206490'>are</span> <span m='206730'>based</span> <span m='207210'>on</span>
  <span m='207370'>the</span> <span m='207530'>trapezoidal</span> <span
  m='208450'>rule,</span> <span m='209570'>and</span> <span
  m='210320'>they're</span> <span m='210880'>for</span> <span
  m='211120'>use</span> <span m='211530'>with</span> <span
  m='212770'>problems</span> <span m='213330'>without</span> <span
  m='213790'>any</span> <span m='214020'>numerical</span> <span
  m='214740'>damping.</span> <span m='216880'>You</span> <span
  m='217170'>can</span> <span m='218220'>see</span> <span m='218590'>the</span>
  <span m='218730'>documentation</span> <span m='219880'>for</span> <span
  m='221230'>more</span> <span m='221960'>details</span> <span
  m='222870'>on</span> <span m='223120'>the</span> <span
  m='223490'>trapezoid</span> <span m='224270'>methods.</span> </p><p><span
  m='225700'>That's</span> <span m='225960'>the</span> <span
  m='226050'>MATLAB</span> <span m='226580'>ODE</span> <span
  m='227100'>Suite</span> <span m='228490'>seven</span> <span
  m='228960'>solvers,</span> <span m='231370'>three</span> <span
  m='231760'>for</span> <span m='231900'>nonstiff</span> <span
  m='232580'>problems</span> <span m='233750'>and</span> <span
  m='234480'>four</span> <span m='234750'>for</span> <span
  m='235020'>stiff</span> <span m='235380'>problems.</span> <span
  m='239020'>You</span> <span m='239180'>may</span> <span m='239370'>well</span>
  <span m='239790'>get</span> <span m='239980'>through</span> <span
  m='241340'>with</span> <span m='241610'>never</span> <span
  m='241950'>using</span> <span m='242370'>anything</span> <span
  m='242800'>but</span> <span m='243960'>ode45</span> <span
  m='245940'>may</span> <span m='246160'>well</span> <span
  m='247080'>serve</span> <span m='247470'>all</span> <span
  m='247680'>your</span> <span m='247830'>needs.</span> </p><p><span
  m='251710'>There's</span> <span m='251920'>a</span> <span
  m='252010'>second</span> <span m='252480'>chart</span> <span
  m='252930'>in</span> <span m='253050'>the</span> <span
  m='253160'>documentation</span> <span m='254910'>that</span> <span
  m='257190'>summarizes</span> <span m='258029'>all</span> <span
  m='258360'>the</span> <span m='258649'>options</span> <span
  m='259380'>that</span> <span m='259519'>are</span> <span
  m='259730'>available</span> <span m='260390'>through</span> <span
  m='260670'>the</span> <span m='261490'>ODE</span> <span m='262130'>Set</span>
  <span m='262860'>function.</span> <span m='264710'>We've</span> <span
  m='265040'>briefly</span> <span m='265620'>mentioned</span> <span
  m='266240'>the</span> <span m='266440'>tolerances,</span> <span
  m='267340'>RelTol</span> <span m='268020'>and</span> <span
  m='268290'>AbsTol--</span> <span m='270370'>the</span> <span
  m='270700'>output</span> <span m='271300'>function--</span> <span
  m='273800'>these</span> <span m='274080'>are</span> <span
  m='274210'>available</span> <span m='275190'>in</span> <span
  m='275400'>all</span> <span m='275770'>seven</span> <span m='276290'>of</span>
  <span m='276510'>the</span> <span m='277600'>solvers.</span> </p><p><span
  m='279090'>There</span> <span m='279260'>are</span> <span
  m='279330'>various</span> <span m='279890'>other</span> <span
  m='280180'>functions--</span> <span m='281050'>various</span> <span
  m='281480'>other</span> <span m='281740'>options--</span> <span
  m='282900'>available</span> <span m='283510'>for</span> <span
  m='283680'>more</span> <span m='283900'>specialized</span> <span
  m='284770'>work,</span> <span m='285770'>including</span> <span
  m='286300'>event</span> <span m='286720'>handling,</span> <span
  m='288950'>providing</span> <span m='289530'>a</span> <span
  m='289620'>Jacobian</span> <span m='290700'>to</span> <span
  m='290930'>the</span> <span m='293150'>stiff</span> <span
  m='293570'>solvers</span> <span m='294620'>so</span> <span
  m='294850'>they</span> <span m='295040'>don't</span> <span
  m='295260'>have</span> <span m='295460'>to</span> <span m='295570'>work</span>
  <span m='295870'>so</span> <span m='296020'>hard</span> <span
  m='296410'>taking</span> <span m='297050'>numerical</span> <span
  m='298390'>differences,</span> <span m='301640'>options</span> <span
  m='302250'>associated</span> <span m='303040'>with</span> <span
  m='303320'>the</span> <span m='303930'>mass</span> <span
  m='304390'>matrices,</span> <span m='308460'>providing</span> <span
  m='308950'>a</span> <span m='309040'>limit</span> <span m='309390'>on</span>
  <span m='309570'>the</span> <span m='309670'>step</span> <span
  m='310020'>size.</span> <span m='311430'>These</span> <span
  m='311600'>are</span> <span m='311760'>all</span> <span m='312200'>our</span>
  <span m='313230'>options</span> <span m='313980'>that</span> <span
  m='314180'>can</span> <span m='314460'>be</span> <span
  m='316730'>specified</span> <span m='317520'>through</span> <span
  m='317810'>ode</span> <span m='318400'>Set</span> <span m='319320'>for</span>
  <span m='319730'>more</span> <span m='321360'>specialized</span> <span
  m='322220'>work</span> <span m='322570'>with</span> <span
  m='322820'>the</span> <span m='323470'>ODE</span> <span
  m='324000'>solvers.</span> </p><p></p>
uid: d255105b3f1c9a1de9fbbc907b26972c
type: courses
layout: video
---
