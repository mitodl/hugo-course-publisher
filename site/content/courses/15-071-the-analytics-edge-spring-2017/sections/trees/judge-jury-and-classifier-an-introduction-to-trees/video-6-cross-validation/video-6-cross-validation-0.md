---
about_this_resource_text: ''
embedded_media:
  - id: Video-YouTube-Stream
    media_location: CROEh9u0VLM
    parent_uid: 2c3b57653e27972f213356dd1c0025e1
    title: Video-YouTube-Stream
    type: Video
    uid: 9906df77faa516ad0fc2ebf8340749f3
  - id: 3Play-3Play YouTube id-Stream
    media_location: CROEh9u0VLM
    parent_uid: 2c3b57653e27972f213356dd1c0025e1
    title: 3Play-3Play YouTube id
    type: 3Play
    uid: 08ef7d5ba2a5bdc9d2e3f45a700beea8
  - id: Thumbnail-YouTube-JPG
    media_location: 'https://img.youtube.com/vi/CROEh9u0VLM/default.jpg'
    parent_uid: 2c3b57653e27972f213356dd1c0025e1
    title: Thumbnail-YouTube-JPG
    type: Thumbnail
    uid: a3fdf70d5968bd1edb565ecbba232ade
  - id: CROEh9u0VLM.srt
    parent_uid: 2c3b57653e27972f213356dd1c0025e1
    technical_location: >-
      https://ocw.mit.edu/courses/sloan-school-of-management/15-071-the-analytics-edge-spring-2017/trees/judge-jury-and-classifier-an-introduction-to-trees/video-6-cross-validation/video-6-cross-validation-0/CROEh9u0VLM.srt
    title: 3play caption file
    type: null
    uid: f54fc97beb9d3625bbf3b8c836eac43b
  - id: CROEh9u0VLM.pdf
    parent_uid: 2c3b57653e27972f213356dd1c0025e1
    technical_location: >-
      https://ocw.mit.edu/courses/sloan-school-of-management/15-071-the-analytics-edge-spring-2017/trees/judge-jury-and-classifier-an-introduction-to-trees/video-6-cross-validation/video-6-cross-validation-0/CROEh9u0VLM.pdf
    title: 3play pdf file
    type: null
    uid: 7c8e88446398b8f669260e0697831267
  - id: Caption-3Play YouTube id-SRT
    parent_uid: 2c3b57653e27972f213356dd1c0025e1
    title: Caption-3Play YouTube id-SRT-English - US
    type: Caption
    uid: 7f15d1a20d9a2f4a07e64a24938fd39c
  - id: Transcript-3Play YouTube id-PDF
    parent_uid: 2c3b57653e27972f213356dd1c0025e1
    title: Transcript-3Play YouTube id-PDF-English - US
    type: Transcript
    uid: bd137ff4d6cdc9d619c565eb86e90cf5
  - id: Video-InternetArchive-MP4
    media_location: >-
      https://archive.org/download/MIT15.071S17/MIT15_071S17_Session_4.2.11_300k.mp4
    parent_uid: 2c3b57653e27972f213356dd1c0025e1
    title: Video-Internet Archive-MP4
    type: Video
    uid: 441ba6c6b367d407c74086f0e66a98bf
inline_embed_id: 44613209video6crossvalidation203303
order_index: 822
parent_uid: aed8634b040dd1af7abb68e999cb9c43
related_resources_text: ''
short_url: video-6-cross-validation-0
technical_location: >-
  https://ocw.mit.edu/courses/sloan-school-of-management/15-071-the-analytics-edge-spring-2017/trees/judge-jury-and-classifier-an-introduction-to-trees/video-6-cross-validation/video-6-cross-validation-0
title: 'Video 6: Cross-Validation'
transcript: >-
  <p><span m='4610'>In</span> <span m='4957'>CART,</span> <span
  m='5304'>the</span> <span m='5651'>value</span> <span m='5998'>of</span> <span
  m='6345'>minbucket</span> <span m='6692'>can</span> <span
  m='7040'>affect</span> <span m='7706'>the</span> <span m='8372'>model's</span>
  <span m='9038'>out-of-sample</span> <span m='9704'>accuracy.</span>
  </p><p><span m='10370'>As</span> <span m='10755'>we</span> <span
  m='11141'>discussed</span> <span m='11527'>earlier</span> <span
  m='11912'>in</span> <span m='12298'>the</span> <span m='12684'>lecture,</span>
  <span m='13070'>if</span> <span m='13586'>minbucket</span> <span
  m='14102'>is</span> <span m='14618'>too</span> <span m='15135'>small,</span>
  <span m='15651'>over-fitting</span> <span m='16167'>might</span> <span
  m='16683'>occur.</span> </p><p><span m='17200'>But</span> <span
  m='17556'>if</span> <span m='17913'>minbucket</span> <span m='18270'>is</span>
  <span m='18626'>too</span> <span m='18983'>large,</span> <span
  m='19340'>the</span> <span m='19696'>model</span> <span m='20053'>might</span>
  <span m='20410'>be</span> <span m='20766'>too</span> <span
  m='21123'>simple.</span> </p><p><span m='21480'>So</span> <span
  m='21898'>how</span> <span m='22317'>should</span> <span m='22736'>we</span>
  <span m='23155'>set</span> <span m='23573'>this</span> <span
  m='23992'>parameter</span> <span m='24411'>value?</span> </p><p><span
  m='24830'>We</span> <span m='25153'>could</span> <span m='25477'>select</span>
  <span m='25800'>the</span> <span m='26124'>value</span> <span
  m='26448'>that</span> <span m='26771'>gives</span> <span m='27095'>the</span>
  <span m='27419'>best</span> <span m='27742'>testing</span> <span
  m='28066'>set</span> <span m='28390'>accuracy,</span> <span
  m='28988'>but</span> <span m='29586'>this</span> <span m='30184'>isn't</span>
  <span m='30782'>right.</span> </p><p><span m='31380'>The</span> <span
  m='31713'>idea</span> <span m='32047'>of</span> <span m='32380'>the</span>
  <span m='32714'>testing</span> <span m='33048'>set</span> <span
  m='33381'>is</span> <span m='33715'>to</span> <span m='34049'>measure</span>
  <span m='34382'>model</span> <span m='34716'>performance</span> <span
  m='35050'>on</span> <span m='35445'>data</span> <span m='35840'>the</span>
  <span m='36235'>model</span> <span m='36630'>has</span> <span
  m='37025'>never</span> <span m='37420'>seen</span> <span
  m='37815'>before.</span> </p><p><span m='38210'>By</span> <span
  m='38535'>picking</span> <span m='38860'>the</span> <span
  m='39185'>value</span> <span m='39510'>of</span> <span
  m='39835'>minbucket</span> <span m='40160'>to</span> <span
  m='40535'>get</span> <span m='40911'>the</span> <span m='41287'>best</span>
  <span m='41662'>test</span> <span m='42038'>set</span> <span
  m='42414'>performance,</span> <span m='42790'>the</span> <span
  m='43293'>testing</span> <span m='43796'>set</span> <span m='44299'>was</span>
  <span m='44802'>implicitly</span> <span m='45305'>used</span> <span
  m='45808'>to</span> <span m='46311'>generate</span> <span m='46814'>the</span>
  <span m='47317'>model.</span> </p><p><span m='47820'>Instead,</span> <span
  m='48300'>we'll</span> <span m='48780'>use</span> <span m='49260'>a</span>
  <span m='49740'>method</span> <span m='50220'>called</span> <span
  m='50700'>K-fold</span> <span m='51180'>Cross</span> <span
  m='51660'>Validation,</span> <span m='52140'>which</span> <span
  m='52544'>is</span> <span m='52948'>one</span> <span m='53352'>way</span>
  <span m='53756'>to</span> <span m='54160'>properly</span> <span
  m='54564'>select</span> <span m='54968'>the</span> <span
  m='55372'>parameter</span> <span m='55776'>value.</span> </p><p><span
  m='56180'>This</span> <span m='56606'>method</span> <span
  m='57033'>works</span> <span m='57460'>by</span> <span m='57886'>going</span>
  <span m='58313'>through</span> <span m='58740'>the</span> <span
  m='59166'>following</span> <span m='59593'>steps.</span> </p><p><span
  m='60020'>First,</span> <span m='60387'>we</span> <span m='60755'>split</span>
  <span m='61122'>the</span> <span m='61490'>training</span> <span
  m='61857'>set</span> <span m='62225'>into</span> <span m='62592'>k</span>
  <span m='62960'>equally</span> <span m='63606'>sized</span> <span
  m='64252'>subsets,</span> <span m='64898'>or</span> <span
  m='65544'>folds.</span> </p><p><span m='66190'>In</span> <span
  m='66741'>this</span> <span m='67293'>example,</span> <span m='67845'>k</span>
  <span m='68396'>equals</span> <span m='68948'>5.</span> </p><p><span
  m='69500'>Then</span> <span m='69951'>we</span> <span m='70403'>select</span>
  <span m='70854'>k</span> <span m='71306'>-</span> <span m='71757'>1,</span>
  <span m='72209'>or</span> <span m='72660'>four</span> <span
  m='73112'>folds,</span> <span m='73563'>to</span> <span
  m='74015'>estimate</span> <span m='74466'>the</span> <span
  m='74918'>model,</span> <span m='75370'>and</span> <span
  m='75746'>compute</span> <span m='76123'>predictions</span> <span
  m='76500'>on</span> <span m='76876'>the</span> <span
  m='77253'>remaining</span> <span m='77630'>one</span> <span
  m='78006'>fold,</span> <span m='78383'>which</span> <span m='78760'>is</span>
  <span m='79175'>often</span> <span m='79590'>referred</span> <span
  m='80005'>to</span> <span m='80420'>as</span> <span m='80835'>the</span> <span
  m='81250'>validation</span> <span m='81665'>set.</span> </p><p><span
  m='82080'>We</span> <span m='82397'>build</span> <span m='82714'>a</span>
  <span m='83031'>model</span> <span m='83348'>and</span> <span
  m='83665'>make</span> <span m='83982'>predictions</span> <span
  m='84300'>for</span> <span m='84938'>each</span> <span
  m='85577'>possible</span> <span m='86215'>parameter</span> <span
  m='86854'>value</span> <span m='87492'>we're</span> <span
  m='88131'>considering.</span> </p><p><span m='88770'>Then</span> <span
  m='89113'>we</span> <span m='89456'>repeat</span> <span m='89799'>this</span>
  <span m='90142'>for</span> <span m='90485'>each</span> <span
  m='90828'>of</span> <span m='91171'>the</span> <span m='91514'>other</span>
  <span m='91857'>folds,</span> <span m='92200'>or</span> <span
  m='92579'>pieces</span> <span m='92959'>of</span> <span m='93339'>our</span>
  <span m='93719'>training</span> <span m='94099'>set.</span> </p><p><span
  m='94479'>So</span> <span m='94773'>we</span> <span m='95068'>would</span>
  <span m='95362'>build</span> <span m='95657'>a</span> <span
  m='95952'>model</span> <span m='96246'>using</span> <span
  m='96541'>folds</span> <span m='96836'>1,</span> <span m='97130'>2,</span>
  <span m='97425'>3,</span> <span m='97720'>and</span> <span m='98227'>5</span>
  <span m='98735'>to</span> <span m='99242'>make</span> <span
  m='99750'>predictions</span> <span m='100257'>on</span> <span
  m='100765'>fold</span> <span m='101272'>4,</span> <span m='101780'>and</span>
  <span m='102150'>then</span> <span m='102521'>we</span> <span
  m='102892'>would</span> <span m='103263'>build</span> <span
  m='103633'>a</span> <span m='104004'>model</span> <span
  m='104375'>using</span> <span m='104746'>folds</span> <span
  m='105116'>1,</span> <span m='105487'>2,</span> <span m='105858'>4,</span>
  <span m='106229'>and</span> <span m='106794'>5</span> <span
  m='107360'>to</span> <span m='107926'>make</span> <span
  m='108491'>predictions</span> <span m='109057'>on</span> <span
  m='109623'>fold</span> <span m='110188'>3,</span> <span m='110754'>etc.</span>
  </p><p><span m='111320'>So</span> <span m='111822'>ultimately,</span> <span
  m='112324'>cross</span> <span m='112826'>validation</span> <span
  m='113328'>builds</span> <span m='113830'>many</span> <span
  m='114483'>models,</span> <span m='115136'>one</span> <span
  m='115789'>for</span> <span m='116442'>each</span> <span
  m='117095'>fold</span> <span m='117748'>and</span> <span
  m='118401'>possible</span> <span m='119054'>parameter</span> <span
  m='119707'>value.</span> </p><p><span m='120360'>Then,</span> <span
  m='120828'>for</span> <span m='121296'>each</span> <span
  m='121765'>candidate</span> <span m='122233'>parameter</span> <span
  m='122701'>value,</span> <span m='123170'>and</span> <span
  m='123501'>for</span> <span m='123832'>each</span> <span
  m='124164'>fold,</span> <span m='124495'>we</span> <span m='124827'>can</span>
  <span m='125158'>compute</span> <span m='125490'>the</span> <span
  m='125948'>accuracy</span> <span m='126406'>of</span> <span
  m='126864'>the</span> <span m='127322'>model.</span> </p><p><span
  m='127780'>This</span> <span m='128243'>plot</span> <span
  m='128706'>shows</span> <span m='129169'>the</span> <span
  m='129632'>possible</span> <span m='130095'>parameter</span> <span
  m='130558'>values</span> <span m='131021'>on</span> <span
  m='131484'>the</span> <span m='131947'>x-axis,</span> <span
  m='132410'>and</span> <span m='132822'>the</span> <span
  m='133234'>accuracy</span> <span m='133646'>of</span> <span
  m='134058'>the</span> <span m='134471'>model</span> <span m='134883'>on</span>
  <span m='135295'>the</span> <span m='135707'>y-axis.</span> </p><p><span
  m='136120'>This</span> <span m='136508'>line</span> <span
  m='136896'>shows</span> <span m='137284'>the</span> <span
  m='137672'>accuracy</span> <span m='138060'>of</span> <span
  m='138449'>our</span> <span m='138837'>model</span> <span m='139225'>on</span>
  <span m='139613'>fold</span> <span m='140001'>1.</span> </p><p><span
  m='140390'>We</span> <span m='140730'>can</span> <span m='141070'>also</span>
  <span m='141410'>compute</span> <span m='141750'>the</span> <span
  m='142090'>accuracy</span> <span m='142430'>of</span> <span
  m='142770'>the</span> <span m='143110'>model</span> <span
  m='143450'>using</span> <span m='143790'>each</span> <span
  m='144180'>of</span> <span m='144570'>the</span> <span m='144960'>other</span>
  <span m='145350'>folds</span> <span m='145740'>as</span> <span
  m='146130'>the</span> <span m='146520'>validation</span> <span
  m='146910'>sets.</span> </p><p><span m='147300'>We</span> <span
  m='147688'>then</span> <span m='148077'>average</span> <span
  m='148466'>the</span> <span m='148855'>accuracy</span> <span
  m='149243'>over</span> <span m='149632'>the</span> <span m='150021'>k</span>
  <span m='150410'>folds</span> <span m='150903'>to</span> <span
  m='151396'>determine</span> <span m='151890'>the</span> <span
  m='152383'>final</span> <span m='152876'>parameter</span> <span
  m='153370'>value</span> <span m='153791'>that</span> <span
  m='154213'>we</span> <span m='154635'>want</span> <span m='155056'>to</span>
  <span m='155478'>use.</span> </p><p><span m='155900'>Typically,</span> <span
  m='156391'>the</span> <span m='156883'>behavior</span> <span
  m='157375'>looks</span> <span m='157866'>like</span> <span
  m='158358'>this--</span> <span m='158850'>if</span> <span
  m='159214'>the</span> <span m='159578'>parameter</span> <span
  m='159942'>value</span> <span m='160307'>is</span> <span m='160671'>too</span>
  <span m='161035'>small,</span> <span m='161400'>then</span> <span
  m='161719'>the</span> <span m='162038'>accuracy</span> <span
  m='162357'>is</span> <span m='162676'>lower,</span> <span
  m='162995'>because</span> <span m='163314'>the</span> <span
  m='163633'>model</span> <span m='163952'>is</span> <span
  m='164271'>probably</span> <span m='164590'>over-fit</span> <span
  m='165060'>to</span> <span m='165530'>the</span> <span
  m='166000'>training</span> <span m='166470'>set.</span> </p><p><span
  m='166940'>But</span> <span m='167336'>if</span> <span m='167732'>the</span>
  <span m='168128'>parameter</span> <span m='168525'>value</span> <span
  m='168921'>is</span> <span m='169317'>too</span> <span
  m='169713'>large,</span> <span m='170110'>then</span> <span
  m='170428'>the</span> <span m='170747'>accuracy</span> <span
  m='171066'>is</span> <span m='171385'>also</span> <span
  m='171704'>lower,</span> <span m='172023'>because</span> <span
  m='172342'>the</span> <span m='172661'>model</span> <span m='172980'>is</span>
  <span m='173679'>too</span> <span m='174379'>simple.</span> </p><p><span
  m='175079'>In</span> <span m='175466'>this</span> <span
  m='175853'>case,</span> <span m='176241'>we</span> <span
  m='176628'>would</span> <span m='177015'>pick</span> <span m='177403'>a</span>
  <span m='177790'>parameter</span> <span m='178177'>value</span> <span
  m='178565'>around</span> <span m='178952'>six,</span> <span
  m='179340'>because</span> <span m='179768'>it</span> <span
  m='180197'>leads</span> <span m='180626'>to</span> <span m='181055'>the</span>
  <span m='181483'>maximum</span> <span m='181912'>average</span> <span
  m='182341'>accuracy</span> <span m='182770'>over</span> <span
  m='183160'>all</span> <span m='183550'>parameter</span> <span
  m='183940'>values.</span> </p><p><span m='186970'>So</span> <span
  m='187404'>far,</span> <span m='187838'>we've</span> <span
  m='188272'>used</span> <span m='188707'>the</span> <span
  m='189141'>parameter</span> <span m='189575'>minbucket</span> <span
  m='190010'>to</span> <span m='190361'>limit</span> <span m='190713'>our</span>
  <span m='191064'>tree</span> <span m='191416'>in</span> <span
  m='191767'>R.</span> <span m='192119'>When</span> <span m='192470'>we</span>
  <span m='192822'>use</span> <span m='193173'>cross</span> <span
  m='193525'>validation</span> <span m='193876'>in</span> <span
  m='194228'>R,</span> <span m='194580'>we'll</span> <span m='195115'>use</span>
  <span m='195651'>a</span> <span m='196186'>parameter</span> <span
  m='196722'>called</span> <span m='197257'>cp</span> <span
  m='197793'>instead.</span> </p><p><span m='198329'>This</span> <span
  m='198865'>is</span> <span m='199401'>the</span> <span
  m='199937'>complexity</span> <span m='200473'>parameter.</span> </p><p><span
  m='201010'>It's</span> <span m='201475'>like</span> <span
  m='201941'>Adjusted</span> <span m='202407'>R-squared</span> <span
  m='202872'>for</span> <span m='203338'>linear</span> <span
  m='203804'>regression,</span> <span m='204270'>and</span> <span
  m='204696'>AIC</span> <span m='205123'>for</span> <span
  m='205550'>logistic</span> <span m='205976'>regression,</span> <span
  m='206403'>in</span> <span m='206830'>that</span> <span m='207256'>it</span>
  <span m='207683'>measures</span> <span m='208110'>the</span> <span
  m='208644'>trade-off</span> <span m='209178'>between</span> <span
  m='209712'>model</span> <span m='210247'>complexity</span> <span
  m='210781'>and</span> <span m='211315'>accuracy</span> <span
  m='211850'>on</span> <span m='212335'>the</span> <span
  m='212820'>training</span> <span m='213305'>set.</span> </p><p><span
  m='213790'>A</span> <span m='214165'>smaller</span> <span m='214541'>cp</span>
  <span m='214916'>value</span> <span m='215292'>leads</span> <span
  m='215667'>to</span> <span m='216043'>a</span> <span m='216418'>bigger</span>
  <span m='216794'>tree,</span> <span m='217170'>so</span> <span
  m='217518'>a</span> <span m='217867'>smaller</span> <span m='218216'>cp</span>
  <span m='218565'>value</span> <span m='218914'>might</span> <span
  m='219263'>over-fit</span> <span m='219612'>the</span> <span
  m='219961'>model</span> <span m='220310'>to</span> <span m='220710'>the</span>
  <span m='221110'>training</span> <span m='221510'>set.</span> </p><p><span
  m='221910'>But</span> <span m='222261'>a</span> <span m='222612'>cp</span>
  <span m='222963'>value</span> <span m='223315'>that's</span> <span
  m='223666'>too</span> <span m='224017'>large</span> <span
  m='224368'>might</span> <span m='224720'>build</span> <span
  m='225133'>a</span> <span m='225546'>model</span> <span
  m='225960'>that's</span> <span m='226373'>too</span> <span
  m='226786'>simple.</span> </p><p><span m='227200'>Let's</span> <span
  m='227535'>go</span> <span m='227870'>to</span> <span m='228205'>R,</span>
  <span m='228540'>and</span> <span m='228875'>use</span> <span
  m='229210'>cross</span> <span m='229545'>validation</span> <span
  m='229880'>to</span> <span m='230277'>select</span> <span
  m='230674'>the</span> <span m='231071'>value</span> <span m='231468'>of</span>
  <span m='231865'>cp</span> <span m='232262'>for</span> <span
  m='232659'>our</span> <span m='233056'>CART</span> <span
  m='233453'>tree.</span> </p><p><span m='233850'>In</span> <span
  m='234250'>our</span> <span m='234650'>R</span> <span
  m='235050'>console,</span> <span m='235450'>let's</span> <span
  m='235850'>try</span> <span m='236250'>cross</span> <span
  m='236650'>validation</span> <span m='237050'>for</span> <span
  m='237490'>our</span> <span m='237930'>CART</span> <span
  m='238370'>model.</span> </p><p><span m='238810'>To</span> <span
  m='239208'>do</span> <span m='239606'>this,</span> <span m='240005'>we</span>
  <span m='240403'>need</span> <span m='240801'>to</span> <span
  m='241200'>install</span> <span m='241598'>and</span> <span
  m='241996'>load</span> <span m='242395'>two</span> <span m='242793'>new</span>
  <span m='243191'>packages.</span> </p><p><span m='243590'>First,</span> <span
  m='244400'>we'll</span> <span m='245210'>install</span> <span
  m='246020'>the</span> <span m='246830'>package</span> <span
  m='247640'>"caret".</span> </p><p><span m='253060'>You</span> <span
  m='253379'>should</span> <span m='253698'>see</span> <span
  m='254017'>some</span> <span m='254336'>lines</span> <span
  m='254655'>run</span> <span m='254974'>in</span> <span m='255293'>your</span>
  <span m='255612'>R</span> <span m='255931'>console,</span> <span
  m='256250'>and</span> <span m='256547'>then</span> <span
  m='256845'>when</span> <span m='257143'>you're</span> <span
  m='257441'>back</span> <span m='257738'>to</span> <span m='258036'>the</span>
  <span m='258334'>blinking</span> <span m='258632'>cursor,</span> <span
  m='258930'>load</span> <span m='259409'>the</span> <span
  m='259889'>package</span> <span m='260369'>with</span> <span
  m='260849'>library(caret).</span> </p><p><span m='265260'>Now,</span> <span
  m='266053'>let's</span> <span m='266846'>install</span> <span
  m='267640'>the</span> <span m='268433'>package</span> <span
  m='269226'>"e1071".</span> </p><p><span m='270020'>So</span> <span
  m='273106'>again,</span> <span m='276193'>install.packages("e1071").</span>
  </p><p><span m='279280'>Again,</span> <span m='279593'>you</span> <span
  m='279907'>should</span> <span m='280220'>see</span> <span
  m='280534'>some</span> <span m='280848'>lines</span> <span
  m='281161'>run</span> <span m='281475'>in</span> <span m='281789'>your</span>
  <span m='282102'>R</span> <span m='282416'>console,</span> <span
  m='282730'>and</span> <span m='283008'>when</span> <span
  m='283287'>you're</span> <span m='283565'>back</span> <span
  m='283844'>to</span> <span m='284122'>the</span> <span
  m='284401'>cursor,</span> <span m='284680'>load</span> <span
  m='286012'>the</span> <span m='287344'>package</span> <span
  m='288676'>with</span> <span m='290008'>library(e1071).</span> </p><p><span
  m='291340'>Now,</span> <span m='291947'>we'll</span> <span
  m='292554'>define</span> <span m='293161'>our</span> <span
  m='293768'>cross</span> <span m='294375'>validation</span> <span
  m='294982'>experiment.</span> </p><p><span m='295590'>First,</span> <span
  m='295953'>we</span> <span m='296316'>need</span> <span m='296679'>to</span>
  <span m='297042'>define</span> <span m='297405'>how</span> <span
  m='297768'>many</span> <span m='298131'>folds</span> <span
  m='298494'>we</span> <span m='298857'>want.</span> </p><p><span
  m='299220'>We</span> <span m='299762'>can</span> <span m='300305'>do</span>
  <span m='300847'>this</span> <span m='301390'>using</span> <span
  m='301932'>the</span> <span m='302475'>trainControl</span> <span
  m='303017'>function.</span> </p><p><span m='303560'>So</span> <span
  m='305143'>we'll</span> <span m='306726'>say</span> <span
  m='308310'>numFolds</span> <span m='309893'>=</span> <span
  m='311476'>trainControl,</span> <span m='313060'>and</span> <span
  m='313825'>then</span> <span m='314591'>in</span> <span
  m='315357'>parentheses,</span> <span m='316122'>method</span> <span
  m='316888'>=</span> <span m='317654'>"cv",</span> <span m='318420'>for</span>
  <span m='319080'>cross</span> <span m='319741'>validation,</span> <span
  m='320402'>and</span> <span m='321063'>then</span> <span
  m='321724'>number</span> <span m='322385'>=</span> <span m='323046'>10,</span>
  <span m='323707'>for</span> <span m='324368'>10</span> <span
  m='325029'>folds.</span> </p><p><span m='325690'>Then</span> <span
  m='325983'>we</span> <span m='326277'>need</span> <span m='326570'>to</span>
  <span m='326864'>pick</span> <span m='327158'>the</span> <span
  m='327451'>possible</span> <span m='327745'>values</span> <span
  m='328039'>for</span> <span m='328332'>our</span> <span m='328626'>cp</span>
  <span m='328920'>parameter,</span> <span m='329804'>using</span> <span
  m='330688'>the</span> <span m='331572'>expand.grid</span> <span
  m='332456'>function.</span> </p><p><span m='333340'>So</span> <span
  m='334387'>we'll</span> <span m='335435'>call</span> <span
  m='336483'>it</span> <span m='337531'>cpGrid,</span> <span
  m='338578'>and</span> <span m='339626'>then</span> <span m='340674'>use</span>
  <span m='341722'>expand.grid,</span> <span m='342770'>where</span> <span
  m='344578'>the</span> <span m='346387'>only</span> <span
  m='348196'>argument</span> <span m='350005'>is</span> <span
  m='351813'>.cp</span> <span m='353622'>=</span> <span
  m='355431'>seq(0.01,0.5,0.01).</span> </p><p><span m='357240'>This</span>
  <span m='357600'>will</span> <span m='357960'>define</span> <span
  m='358320'>our</span> <span m='358680'>cp</span> <span
  m='359040'>parameters</span> <span m='359400'>to</span> <span
  m='360100'>test</span> <span m='360800'>as</span> <span
  m='361500'>numbers</span> <span m='362200'>from</span> <span
  m='362900'>0.01</span> <span m='363600'>to</span> <span m='364300'>0.5,</span>
  <span m='365000'>in</span> <span m='365700'>increments</span> <span
  m='366400'>of</span> <span m='367100'>0.01.</span> </p><p><span
  m='367800'>Now,</span> <span m='368305'>we're</span> <span
  m='368811'>ready</span> <span m='369317'>to</span> <span
  m='369822'>perform</span> <span m='370328'>cross</span> <span
  m='370834'>validation.</span> </p><p><span m='371340'>We'll</span> <span
  m='371747'>do</span> <span m='372155'>this</span> <span
  m='372562'>using</span> <span m='372970'>the</span> <span
  m='373377'>train</span> <span m='373785'>function,</span> <span
  m='374192'>where</span> <span m='374600'>the</span> <span
  m='374967'>first</span> <span m='375334'>argument</span> <span
  m='375701'>is</span> <span m='376068'>similar</span> <span
  m='376435'>to</span> <span m='376802'>that</span> <span m='377170'>when</span>
  <span m='377557'>we're</span> <span m='377945'>building</span> <span
  m='378332'>models.</span> </p><p><span m='378720'>It's</span> <span
  m='379396'>the</span> <span m='380072'>dependent</span> <span
  m='380748'>variable,</span> <span m='381424'>Reverse,</span> <span
  m='382100'>followed</span> <span m='382539'>by</span> <span
  m='382978'>a</span> <span m='383417'>tilde</span> <span
  m='383856'>symbol,</span> <span m='384295'>and</span> <span
  m='384734'>then</span> <span m='385173'>the</span> <span
  m='385612'>independent</span> <span m='386051'>variables</span> <span
  m='386490'>separated</span> <span m='387540'>by</span> <span
  m='388590'>plus</span> <span m='389640'>signs--</span> <span
  m='390690'>Circuit</span> <span m='391740'>+</span> <span
  m='392790'>Issue</span> <span m='393840'>+</span> <span
  m='394890'>Petitioner</span> <span m='395940'>+</span> <span
  m='396990'>Respondent</span> <span m='399756'>+</span> <span
  m='402522'>LowerCourt</span> <span m='405288'>+</span> <span
  m='408054'>Unconst.</span> </p><p><span m='410820'>Our</span> <span
  m='411313'>data</span> <span m='411806'>set</span> <span
  m='412299'>here</span> <span m='412792'>is</span> <span
  m='413285'>Train,</span> <span m='413778'>with</span> <span
  m='414271'>a</span> <span m='414764'>capital</span> <span m='415257'>T,</span>
  <span m='415750'>and</span> <span m='416364'>then</span> <span
  m='416979'>we</span> <span m='417593'>need</span> <span m='418208'>to</span>
  <span m='418822'>add</span> <span m='419437'>the</span> <span
  m='420051'>arguments</span> <span m='420666'>method</span> <span
  m='421280'>=</span> <span m='421895'>"rpart",</span> <span
  m='422510'>since</span> <span m='422880'>we</span> <span
  m='423250'>want</span> <span m='423620'>to</span> <span
  m='423990'>cross</span> <span m='424360'>validate</span> <span
  m='424730'>a</span> <span m='425100'>CART</span> <span
  m='425470'>model,</span> <span m='425840'>and</span> <span
  m='426781'>then</span> <span m='427722'>trControl</span> <span
  m='428664'>=</span> <span m='429605'>numFolds,</span> <span
  m='430547'>the</span> <span m='431488'>output</span> <span
  m='432430'>of</span> <span m='433354'>our</span> <span
  m='434278'>trainControl</span> <span m='435203'>function,</span> <span
  m='436127'>and</span> <span m='437052'>then</span> <span
  m='437976'>tuneGrid</span> <span m='438901'>=</span> <span
  m='439825'>cpGrid,</span> <span m='440750'>the</span> <span
  m='441456'>output</span> <span m='442163'>of</span> <span
  m='442870'>the</span> <span m='443576'>expand.grid</span> <span
  m='444283'>function.</span> </p><p><span m='444990'>If</span> <span
  m='445312'>you</span> <span m='445634'>hit</span> <span
  m='445956'>Enter,</span> <span m='446278'>it</span> <span
  m='446600'>might</span> <span m='446922'>take</span> <span m='447244'>a</span>
  <span m='447566'>little</span> <span m='447888'>while,</span> <span
  m='448210'>but</span> <span m='448471'>after</span> <span m='448732'>a</span>
  <span m='448994'>few</span> <span m='449255'>seconds,</span> <span
  m='449517'>you</span> <span m='449778'>should</span> <span
  m='450040'>get</span> <span m='450410'>a</span> <span m='450780'>table</span>
  <span m='451150'>describing</span> <span m='451520'>the</span> <span
  m='451890'>cross</span> <span m='452260'>validation</span> <span
  m='452630'>accuracy</span> <span m='453516'>for</span> <span
  m='454402'>different</span> <span m='455288'>cp</span> <span
  m='456174'>parameters.</span> </p><p><span m='457060'>The</span> <span
  m='457498'>first</span> <span m='457936'>column</span> <span
  m='458374'>gives</span> <span m='458812'>the</span> <span m='459250'>cp</span>
  <span m='459688'>parameter</span> <span m='460126'>that</span> <span
  m='460564'>was</span> <span m='461002'>tested,</span> <span
  m='461440'>and</span> <span m='461753'>the</span> <span
  m='462067'>second</span> <span m='462381'>column</span> <span
  m='462695'>gives</span> <span m='463008'>the</span> <span
  m='463322'>cross</span> <span m='463636'>validation</span> <span
  m='463950'>accuracy</span> <span m='464544'>for</span> <span
  m='465138'>that</span> <span m='465732'>cp</span> <span
  m='466326'>value.</span> </p><p><span m='466920'>The</span> <span
  m='467558'>accuracy</span> <span m='468197'>starts</span> <span
  m='468835'>lower,</span> <span m='469474'>and</span> <span
  m='470112'>then</span> <span m='470751'>increases,</span> <span
  m='471390'>and</span> <span m='471809'>then</span> <span
  m='472228'>will</span> <span m='472647'>start</span> <span
  m='473066'>decreasing</span> <span m='473485'>again,</span> <span
  m='473905'>as</span> <span m='474324'>we</span> <span m='474743'>saw</span>
  <span m='475162'>in</span> <span m='475581'>the</span> <span
  m='476000'>slides.</span> </p><p><span m='476420'>At</span> <span
  m='476857'>the</span> <span m='477295'>bottom</span> <span
  m='477732'>of</span> <span m='478170'>the</span> <span
  m='478607'>output,</span> <span m='479045'>it</span> <span
  m='479482'>says,</span> <span m='479920'>"Accuracy</span> <span
  m='480324'>was</span> <span m='480729'>used</span> <span m='481133'>to</span>
  <span m='481538'>select</span> <span m='481942'>the</span> <span
  m='482347'>optimal</span> <span m='482751'>model</span> <span
  m='483156'>using</span> <span m='483560'>the</span> <span
  m='483965'>largest</span> <span m='484370'>value.</span> </p><p><span
  m='485510'>The</span> <span m='486024'>final</span> <span
  m='486539'>value</span> <span m='487053'>used</span> <span
  m='487568'>for</span> <span m='488082'>the</span> <span
  m='488597'>model</span> <span m='489111'>was</span> <span m='489626'>cp</span>
  <span m='490140'>=</span> <span m='490655'>0.18."</span> <span
  m='491170'>This</span> <span m='491527'>is</span> <span m='491885'>the</span>
  <span m='492243'>cp</span> <span m='492600'>value</span> <span
  m='492958'>we</span> <span m='493316'>want</span> <span m='493673'>to</span>
  <span m='494031'>use</span> <span m='494389'>in</span> <span
  m='494746'>our</span> <span m='495104'>CART</span> <span
  m='495462'>model.</span> </p><p><span m='495820'>So</span> <span
  m='496113'>now</span> <span m='496407'>let's</span> <span
  m='496701'>create</span> <span m='496995'>a</span> <span m='497289'>new</span>
  <span m='497583'>CART</span> <span m='497876'>model</span> <span
  m='498170'>with</span> <span m='498464'>this</span> <span
  m='498758'>value</span> <span m='499052'>of</span> <span m='499346'>cp,</span>
  <span m='499640'>instead</span> <span m='500252'>of</span> <span
  m='500864'>the</span> <span m='501476'>minbucket</span> <span
  m='502088'>parameter.</span> </p><p><span m='502700'>We'll</span> <span
  m='503890'>call</span> <span m='505080'>this</span> <span
  m='506270'>model</span> <span m='507460'>StevensTreeCV,</span> <span
  m='508650'>and</span> <span m='509060'>we'll</span> <span
  m='509470'>use</span> <span m='509880'>the</span> <span
  m='510290'>rpart</span> <span m='510700'>function,</span> <span
  m='511110'>like</span> <span m='511520'>we</span> <span m='511930'>did</span>
  <span m='512340'>earlier,</span> <span m='512750'>to</span> <span
  m='513468'>predict</span> <span m='514187'>Reverse</span> <span
  m='514906'>using</span> <span m='515625'>all</span> <span m='516344'>of</span>
  <span m='517063'>our</span> <span m='517782'>independent</span> <span
  m='518501'>variables:</span> <span m='519220'>Circuit,</span> <span
  m='522105'>Issue,</span> <span m='524990'>Petitioner,</span> <span
  m='527875'>Respondent,</span> <span m='530760'>LowerCourt,</span> <span
  m='532680'>and</span> <span m='534600'>Unconst.</span> </p><p><span
  m='536520'>Our</span> <span m='537184'>data</span> <span m='537849'>set</span>
  <span m='538513'>here</span> <span m='539178'>is</span> <span
  m='539843'>Train,</span> <span m='540507'>and</span> <span
  m='541172'>then</span> <span m='541836'>we</span> <span m='542501'>want</span>
  <span m='543166'>method</span> <span m='543830'>=</span> <span
  m='544495'>"class",</span> <span m='545160'>since</span> <span
  m='545637'>we're</span> <span m='546115'>building</span> <span
  m='546592'>a</span> <span m='547070'>classification</span> <span
  m='547547'>tree,</span> <span m='548025'>and</span> <span m='548502'>cp</span>
  <span m='548980'>=</span> <span m='551345'>0.18.</span> </p><p><span
  m='553710'>Now,</span> <span m='554084'>let's</span> <span
  m='554459'>make</span> <span m='554833'>predictions</span> <span
  m='555208'>on</span> <span m='555582'>our</span> <span m='555957'>test</span>
  <span m='556331'>set</span> <span m='556706'>using</span> <span
  m='557080'>this</span> <span m='557455'>model.</span> </p><p><span
  m='557830'>We'll</span> <span m='558788'>call</span> <span
  m='559746'>our</span> <span m='560704'>predictions</span> <span
  m='561662'>PredictCV,</span> <span m='562620'>and</span> <span
  m='562970'>we'll</span> <span m='563320'>use</span> <span
  m='563670'>the</span> <span m='564020'>predict</span> <span
  m='564370'>function</span> <span m='564720'>to</span> <span
  m='565600'>make</span> <span m='566480'>predictions</span> <span
  m='567360'>using</span> <span m='568240'>the</span> <span
  m='569120'>model</span> <span m='570000'>StevensTreeCV,</span> <span
  m='570880'>the</span> <span m='571535'>newdata</span> <span
  m='572191'>set</span> <span m='572847'>Test,</span> <span
  m='573503'>and</span> <span m='574159'>we</span> <span m='574815'>want</span>
  <span m='575470'>to</span> <span m='576126'>add</span> <span
  m='576782'>type</span> <span m='577438'>=</span> <span
  m='578094'>"class",</span> <span m='578750'>so</span> <span
  m='579280'>that</span> <span m='579810'>we</span> <span m='580340'>get</span>
  <span m='580870'>class</span> <span m='581400'>predictions.</span>
  </p><p><span m='581930'>Now</span> <span m='582315'>let's</span> <span
  m='582700'>create</span> <span m='583085'>our</span> <span
  m='583470'>confusion</span> <span m='583855'>matrix,</span> <span
  m='584240'>using</span> <span m='584654'>the</span> <span
  m='585069'>table</span> <span m='585483'>function,</span> <span
  m='585898'>where</span> <span m='586312'>we</span> <span
  m='586727'>first</span> <span m='587141'>give</span> <span
  m='587556'>the</span> <span m='587970'>true</span> <span
  m='588385'>outcome,</span> <span m='588800'>Test$Reverse,</span> <span
  m='589851'>and</span> <span m='590903'>then</span> <span m='591955'>our</span>
  <span m='593006'>predictions,</span> <span m='594058'>PredictCV.</span>
  </p><p><span m='595110'>So</span> <span m='595745'>the</span> <span
  m='596380'>accuracy</span> <span m='597015'>of</span> <span
  m='597650'>this</span> <span m='598285'>model</span> <span
  m='598920'>is</span> <span m='599555'>59</span> <span m='600190'>+</span>
  <span m='600825'>64,</span> <span m='601460'>divided</span> <span
  m='601971'>by</span> <span m='602482'>the</span> <span m='602994'>total</span>
  <span m='603505'>number</span> <span m='604017'>in</span> <span
  m='604528'>this</span> <span m='605040'>table,</span> <span
  m='605551'>59</span> <span m='606062'>+</span> <span m='606574'>18</span>
  <span m='607085'>+</span> <span m='607597'>29</span> <span m='608108'>+</span>
  <span m='608620'>64,</span> <span m='609108'>the</span> <span
  m='609596'>total</span> <span m='610084'>number</span> <span
  m='610572'>of</span> <span m='611060'>observations</span> <span
  m='611548'>in</span> <span m='612036'>our</span> <span m='612524'>test</span>
  <span m='613012'>set.</span> </p><p><span m='613500'>So</span> <span
  m='614060'>the</span> <span m='614620'>accuracy</span> <span
  m='615180'>of</span> <span m='615740'>this</span> <span
  m='616300'>model</span> <span m='616860'>is</span> <span
  m='617420'>0.724.</span> </p><p><span m='617980'>Remember</span> <span
  m='618366'>that</span> <span m='618753'>the</span> <span
  m='619140'>accuracy</span> <span m='619526'>of</span> <span
  m='619913'>our</span> <span m='620300'>previous</span> <span
  m='620686'>CART</span> <span m='621073'>model</span> <span
  m='621460'>was</span> <span m='622965'>0.659.</span> </p><p><span
  m='624470'>Cross</span> <span m='624805'>validation</span> <span
  m='625141'>helps</span> <span m='625477'>us</span> <span
  m='625812'>make</span> <span m='626148'>sure</span> <span
  m='626484'>we're</span> <span m='626820'>selecting</span> <span
  m='627328'>a</span> <span m='627836'>good</span> <span
  m='628344'>parameter</span> <span m='628852'>value,</span> <span
  m='629360'>and</span> <span m='629756'>often</span> <span
  m='630152'>this</span> <span m='630548'>will</span> <span
  m='630944'>significantly</span> <span m='631340'>increase</span> <span
  m='632070'>the</span> <span m='632800'>accuracy.</span> </p><p><span
  m='633530'>If</span> <span m='633853'>we</span> <span m='634177'>had</span>
  <span m='634500'>already</span> <span m='634824'>happened</span> <span
  m='635148'>to</span> <span m='635471'>select</span> <span m='635795'>a</span>
  <span m='636119'>good</span> <span m='636442'>parameter</span> <span
  m='636766'>value,</span> <span m='637090'>then</span> <span
  m='637434'>the</span> <span m='637778'>accuracy</span> <span
  m='638123'>might</span> <span m='638467'>not</span> <span m='638812'>of</span>
  <span m='639156'>increased</span> <span m='639501'>that</span> <span
  m='639845'>much.</span> </p><p><span m='640190'>But</span> <span
  m='640588'>by</span> <span m='640986'>using</span> <span
  m='641385'>cross</span> <span m='641783'>validation,</span> <span
  m='642181'>we</span> <span m='642580'>can</span> <span m='643024'>be</span>
  <span m='643468'>sure</span> <span m='643912'>that</span> <span
  m='644356'>we're</span> <span m='644800'>selecting</span> <span
  m='645244'>a</span> <span m='645688'>smart</span> <span
  m='646132'>parameter</span> <span m='646576'>value.</span> </p>
uid: 2c3b57653e27972f213356dd1c0025e1
type: course
layout: video
---
